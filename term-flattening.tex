\begin{figure}
  \judgbox{\flattenTerm{p}{\selection}}{$p$ disassembles to $\selection$ \note{todo: different terminology}}
  \begin{mathpar}
    \inferrule[]{
    }{
      \flattenTerm{\term{\ophole}}{\optile{\ophole}}
    }\hspace{20pt}
    \inferrule[]{
    }{
      \flattenTerm{\term{\svar{x}}}{\optile{\svar{x}}}
    }\hspace{20pt}
    \inferrule[]{
      \flattenTerm{p}{\tiles^{\pat}}
    }{
      \flattenTerm{\term{\sparen{p}}}{\optile{\sparen{\tiles^{\pat}}}}
    }\\
    \inferrule[]{
      \flattenTerm{p_1}{\selection_1} \\
      \flattenTerm{p_2}{\selection_2}
    }{
      \flattenTerm{\term{\sbinhole{p_1}{p_2}}}{\selection_1~\bintile{\binhole}~\selection_2}
    }\hspace{20pt}
    \inferrule[]{
      \flattenTerm{p_1}{\selection_1} \\
      \flattenTerm{p_2}{\selection_2}
    }{
      \flattenTerm{\term{\sprod{p_1}{p_2}}}{\selection_1~\bintile{\tprod}~\selection_2}
    }
  \end{mathpar}

  \vspace{10pt}
  \judgbox{\flattenTerm{e}{\selection}}{$e$ disassembles to $\selection$ \note{todo: different terminology}}
  \begin{mathpar}
    \inferrule[]{
    }{
      \flattenTerm{\term{\ophole}}{\optile{\ophole}}
    }\hspace{15pt}
    \inferrule[]{
    }{
      \flattenTerm{\term{\snumlit{n}}}{\optile{\snumlit{n}}}
    }\hspace{15pt}
    \inferrule[]{
    }{
      \flattenTerm{\term{\svar{x}}}{\optile{\svar{x}}}
    }\hspace{15pt}
    \inferrule[]{
      \flattenTerm{e}{\tiles^{\expr}}
    }{
      \flattenTerm{\term{\sparen{e}}}{\optile{\sparen{\tiles^{\expr}}}}
    }\\
    \inferrule[]{
      \flattenTerm{e_1}{\selection_1} \\
      \flattenTerm{e_2}{\selection_2}
    }{
      \flattenTerm{\term{\sbinhole{e_1}{e_2}}}{\selection_1~\bintile{\binhole}~\selection_2}
    }\hspace{20pt}
    \inferrule[]{
      \flattenTerm{e_1}{\selection_1} \\
      \flattenTerm{e_2}{\selection_2}
    }{
      \flattenTerm{\term{\sprod{e_1}{e_2}}}{\selection_1~\bintile{\tprod}~\selection_2}
    }\\
    \inferrule[]{
      \flattenTerm{p}{\tiles^{\pat}} \\
      \flattenTerm{e}{\selection}
    }{
      \flattenTerm{\term{\slam{p}{e}}}{\pretile{\tlam{\tiles^{\pat}}}~\selection}
    }\\
    \inferrule[]{
      \flattenTerm{p}{\tiles^{\pat}} \\
      \flattenTerm{e_1}{\tiles^{\expr}} \\
      \flattenTerm{e_2}{\selection}
    }{
      \flattenTerm{\term{\slet{p}{e_1}{e_2}}}{\pretile{\tlet{\tiles^{\pat}}{\tiles^{\expr}}}~\selection}
    }
  \end{mathpar}

  \caption{
    Term disassembly
  }
  \label{fig:flatten-term}
  \end{figure}