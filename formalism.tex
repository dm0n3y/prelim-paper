% !TEX root = prelim-paper.tex

\section{Editor Calculus}\label{sec:formalism}

\note{think about name of calculus as opposed to implementation}

\subsection{Tiles, tokens, \& selections}
\input{token-syntax}
\input{selection-syntax}
\input{disassemble-tile}
\input{disassemble-selection}

\note{
  discuss the syntax of
  tiles (Fig \ref{fig:tile-syntax}),
  tokens (Fig \ref{fig:token-syntax}),
  selections (Fig \ref{fig:selection-syntax})
}

\note{
  discuss
    disassembly of tiles (Fig \ref{fig:disassemble-tile}),
    disassembly of selections (Fig \ref{fig:disassemble-selection}),
    $\succeq$ partial order and parsing function
}

\begin{definition}
  $\searrow^*$ is the reflexive transitive
  closure of $\searrow$.
\end{definition}

\begin{lemma}
  $\searrow^*$ is a partial order.
\end{lemma}

\begin{lemma}\label{lemma:unique-parsed-selection}
  For every selection $\Psi$, there is a unique maximal
  element $\Psi'$ such that $\Psi'\searrow^*\Psi$.
\end{lemma}

\begin{definition}
  Let $parseSelection$ be the function that takes a selection
  and returns the unique maximal selection guaranteed to exist
  by Lemma \ref{lemma:unique-parsed-selection}.
\end{definition}


\subsection{Frames \& zippers}
\input{frame-syntax}
\input{zipper-syntax}
\input{disassemble-frame-tile}

\note{give an example of a frame to clarify what's going on}

\begin{definition}
  $\zeta^s_1\nearrow\zeta^s_2$ if $\disassembleTileFrame{\zeta^s_1} = \zeta^s_2$.
  \note{defined this for symmetry with diassembling of tiles}
\end{definition}

\begin{definition}
  $\nearrow^*$ is the reflexive transitive closure of $\nearrow$.
\end{definition}

\begin{lemma}
  $\nearrow^*$ is a partial order.
\end{lemma}

\begin{lemma}
  For every zipper $\zip^s_1 = \zipper{\pointing{\selection_1}{\selection_2}}{\tfrelem^s}$, there exists
  a unique minimal element $\zip^s_2$ such that $\zip^s_2 \nearrow^* \zip^s_1$.
\end{lemma}

\begin{definition}
  Let $parseZipper$ be the function that takes a selection
  and returns the unique maximal selection guaranteed to exist
  by Lemma \ref{lemma:unique-parsed-selection}.
\end{definition}


\input{action-syntax}
\input{action-judgment}

\subsubsection{Actions}
\note{
  Define actions more generally than \tylr~ implementation,
  such that delimiters are assigned sorts to their ends,
  selections are not restricted to shards and
  same-sort tiles, and only selections whose ends are the
  same may enter restructuring mode.
}

% (2 * [3])  ->  (2 * (3 + [_]))

\begin{itemize}
  \item explain action judgment + choice rules
  \item theorems
  \begin{itemize}
    \item movability
    \item selectability
    \item restructuring is sound and complete
  \end{itemize}
\end{itemize}

\subsection{Typechecking}
\note{
  Define tree-structured variants of tiles and frames.
  Define precedence parser that converts linear forms to tree forms
  (or assume existence of such parser?).
  Define type
}
